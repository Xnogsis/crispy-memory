<script>
  console.log('unlock script loaded');

  var data = null;
  document.addEventListener('keydown', async function(e) {
    console.log('key:', e.key, 'dataBefore:', data);
    var key = e.key;
    if (key.length !== 1) return;
    key = key.toLowerCase();

    if (key === 'r') {
      data = '';
      console.log('started capture');
      return;
    } else if (data !== null) {
      data += key;
      console.log('data now:', data);
    }

    if (data && data.length === 5) {
      const p = data;
      data = null;
      console.log('captured code:', p);

      if (p === '099ae') {
        try {
          const res = await fetch('real-site.html', { method: 'HEAD' });
          console.log('HEAD status:', res.status);
          if (res.ok) {
            window.location.href = 'real-site.html';
          } else {
            alert('real-site.html not found.');
          }
        } catch (err) {
          console.error('fetch error:', err);
          alert('Error checking for real-site.html.');
        }
      } else {
        console.log('wrong code â€” reloading');
        location.reload();
      }
    }
  });
</script>
